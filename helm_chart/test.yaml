---
# Source: python-web-app/charts/primarydb/templates/secrets.yaml
apiVersion: v1
kind: Secret
metadata:
  name: python-app-secrets
  namespace: python-app
type: Opaque
data:
  POSTGRES_PASSWORD: "S25pdDE2ODQxMg=="
  MAIL_PASSWORD: "MTIzNDU="
---
# Source: python-web-app/charts/primarydb/templates/configmaps.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: release-name-configmap
  namespace: python-app
data:
  initial.sql: "SET password_encryption = 'scram-sha-256';\r\nCREATE ROLE repuser WITH
    REPLICATION PASSWORD 'changeme' LOGIN;\r\nSELECT * FROM pg_create_physical_replication_slot('replica_1_slot');\r\nCREATE
    TABLE public.contact (\r\nsr integer NOT NULL,\r\nname text NOT NULL,\r\nphone_num
    character varying(15) NOT NULL,\r\nmsg text NOT NULL,\r\ndate timestamp without
    time zone DEFAULT CURRENT_TIMESTAMP NOT NULL,\r\nemail character varying(50) NOT
    NULL\r\n);\r\nCREATE SEQUENCE public.contact_sr_no_seq\r\nSTART WITH 1\r\nINCREMENT
    BY 1\r\nNO MINVALUE\r\nNO MAXVALUE\r\nCACHE 1;\r\nALTER SEQUENCE public.contact_sr_no_seq
    OWNED BY public.contact.sr;\r\nCREATE TABLE public.posts (\r\nsr integer NOT NULL,\r\ntitle
    character varying(200) NOT NULL,\r\ntagline character varying(50) NOT NULL,\r\nimg_file
    character varying(50) NOT NULL,\r\nslug character varying(25) NOT NULL,\r\ncontent
    character varying(500) NOT NULL,\r\ndate timestamp without time zone DEFAULT CURRENT_TIMESTAMP
    NOT NULL\r\n);\r\nCREATE SEQUENCE public.posts_sr_no_seq\r\nSTART WITH 1\r\nINCREMENT
    BY 1\r\nNO MINVALUE\r\nNO MAXVALUE\r\nCACHE 1;\r\nALTER SEQUENCE public.posts_sr_no_seq
    OWNED BY public.posts.sr;\r\nCREATE TABLE public.users (\r\nsrno integer NOT NULL,\r\npsswd
    bytea NOT NULL,\r\nemail character varying(60) NOT NULL,\r\ncreation_time timestamp
    without time zone NOT NULL\r\n);\r\nCREATE SEQUENCE public.users_srno_seq\r\nAS
    integer\r\nSTART WITH 1\r\nINCREMENT BY 1\r\nNO MINVALUE\r\nNO MAXVALUE\r\nCACHE
    1;\r\nALTER SEQUENCE public.users_srno_seq OWNED BY public.users.srno;\r\nALTER
    TABLE ONLY public.contact ALTER COLUMN sr SET DEFAULT nextval('public.contact_sr_no_seq'::regclass);\r\nALTER
    TABLE ONLY public.posts ALTER COLUMN sr SET DEFAULT nextval('public.posts_sr_no_seq'::regclass);\r\nALTER
    TABLE ONLY public.users ALTER COLUMN srno SET DEFAULT nextval('public.users_srno_seq'::regclass);\r\nGRANT
    SELECT ON TABLE public.contact TO admin;\r\nGRANT SELECT ON TABLE public.posts TO
    admin;\r\nGRANT SELECT ON TABLE public.users TO admin;"
  pg_hba.conf: |-
    # PostgreSQL Client Authentication Configuration File
    # ===================================================
    #
    # Refer to the "Client Authentication" section in the PostgreSQL
    # documentation for a complete description of this file.  A short
    # synopsis follows.
    #
    # This file controls: which hosts are allowed to connect, how clients
    # are authenticated, which PostgreSQL user names they can use, which
    # databases they can access.  Records take one of these forms:
    #
    # local      DATABASE  USER  METHOD  [OPTIONS]
    # host       DATABASE  USER  ADDRESS  METHOD  [OPTIONS]
    # hostssl    DATABASE  USER  ADDRESS  METHOD  [OPTIONS]
    # hostnossl  DATABASE  USER  ADDRESS  METHOD  [OPTIONS]
    #
    # (The uppercase items must be replaced by actual values.)
    #
    # The first field is the connection type: "local" is a Unix-domain
    # socket, "host" is either a plain or SSL-encrypted TCP/IP socket,
    # "hostssl" is an SSL-encrypted TCP/IP socket, and "hostnossl" is a
    # plain TCP/IP socket.
    #
    # DATABASE can be "all", "sameuser", "samerole", "replication", a
    # database name, or a comma-separated list thereof. The "all"
    # keyword does not match "replication". Access to replication
    # must be enabled in a separate record (see example below).
    #
    # USER can be "all", a user name, a group name prefixed with "+", or a
    # comma-separated list thereof.  In both the DATABASE and USER fields
    # you can also write a file name prefixed with "@" to include names
    # from a separate file.
    #
    # ADDRESS specifies the set of hosts the record matches.  It can be a
    # host name, or it is made up of an IP address and a CIDR mask that is
    # an integer (between 0 and 32 (IPv4) or 128 (IPv6) inclusive) that
    # specifies the number of significant bits in the mask.  A host name
    # that starts with a dot (.) matches a suffix of the actual host name.
    # Alternatively, you can write an IP address and netmask in separate
    # columns to specify the set of hosts.  Instead of a CIDR-address, you
    # can write "samehost" to match any of the server's own IP addresses,
    # or "samenet" to match any address in any subnet that the server is
    # directly connected to.
    #
    # METHOD can be "trust", "reject", "md5", "password", "scram-sha-256",
    # "gss", "sspi", "ident", "peer", "pam", "ldap", "radius" or "cert".
    # Note that "password" sends passwords in clear text; "md5" or
    # "scram-sha-256" are preferred since they send encrypted passwords.
    #
    # OPTIONS are a set of options for the authentication in the format
    # NAME=VALUE.  The available options depend on the different
    # authentication methods -- refer to the "Client Authentication"
    # section in the documentation for a list of which options are
    # available for which authentication methods.
    #
    # Database and user names containing spaces, commas, quotes and other
    # special characters must be quoted.  Quoting one of the keywords
    # "all", "sameuser", "samerole" or "replication" makes the name lose
    # its special character, and just match a database or username with
    # that name.
    #
    # This file is read on server startup and when the server receives a
    # SIGHUP signal.  If you edit the file on a running system, you have to
    # SIGHUP the server for the changes to take effect, run "pg_ctl reload",
    # or execute "SELECT pg_reload_conf()".
    #
    # Put your actual configuration here
    # ----------------------------------
    #
    # If you want to allow non-local connections, you need to add more
    # "host" records.  In that case you will also need to make PostgreSQL
    # listen on a non-local interface via the listen_addresses
    # configuration parameter, or via the -i or -h command line switches.
  
    # CAUTION: Configuring the system for local "trust" authentication
    # allows any local user to connect as any PostgreSQL user, including
    # the database superuser.  If you do not trust all your local users,
    # use another authentication method.
  
  
    # TYPE  DATABASE        USER            ADDRESS                 METHOD
  
    # "local" is for Unix domain socket connections only
    local   all             all                                     trust
    # IPv4 local connections:
    host    all             all             127.0.0.1/32            trust
    # IPv6 local connections:
    host    all             all             ::1/128                 trust
    # Allow replication connections from localhost, by a user with the
    # replication privilege.
    local   replication     all                                     trust
    host    replication     all             127.0.0.1/32            trust
    host    replication     all             ::1/128                 trust
  
    host all all all md5
    host    replication     repuser         0.0.0.0/0       scram-sha-256
  postgresql.conf: "# -----------------------------\n# PostgreSQL configuration file\n#
    -----------------------------\n#\n# This file consists of lines of the form:\n#\n#
    \  name = value\n#\n# (The \"=\" is optional.)  Whitespace may be used.  Comments
    are introduced with\n# \"#\" anywhere on a line.  The complete list of parameter
    names and allowed\n# values can be found in the PostgreSQL documentation.\n#\n#
    The commented-out settings shown in this file represent the default values.\n# Re-commenting
    a setting is NOT sufficient to revert it to the default value;\n# you need to reload
    the server.\n#\n# This file is read on server startup and when the server receives
    a SIGHUP\n# signal.  If you edit the file on a running system, you have to SIGHUP
    the\n# server for the changes to take effect, run \"pg_ctl reload\", or execute\n#
    \"SELECT pg_reload_conf()\".  Some parameters, which are marked below,\n# require
    a server shutdown and restart to take effect.\n#\n# Any parameter can also be given
    as a command-line option to the server, e.g.,\n# \"postgres -c log_connections=on\".
    \ Some parameters can be changed at run time\n# with the \"SET\" SQL command.\n#\n#
    Memory units:  kB = kilobytes        Time units:  ms  = milliseconds\n#                MB
    = megabytes                     s   = seconds\n#                GB = gigabytes                     min
    = minutes\n#                TB = terabytes                     h   = hours\n#                                                   d
    \  = days\n\n\n#------------------------------------------------------------------------------\n#
    FILE LOCATIONS\n#------------------------------------------------------------------------------\n\n#
    The default values of these variables are driven from the -D command-line\n# option
    or PGDATA environment variable, represented here as ConfigDir.\n\n#data_directory
    = 'ConfigDir'\t\t# use data in another directory\n\t\t\t\t\t# (change requires restart)\n#hba_file
    = 'ConfigDir/pg_hba.conf'\t# host-based authentication file\n\t\t\t\t\t# (change
    requires restart)\n#ident_file = 'ConfigDir/pg_ident.conf'\t# ident configuration
    file\n\t\t\t\t\t# (change requires restart)\n\n# If external_pid_file is not explicitly
    set, no extra PID file is written.\n#external_pid_file = ''\t\t\t# write an extra
    PID file\n\t\t\t\t\t# (change requires restart)\n\n\n#------------------------------------------------------------------------------\n#
    CONNECTIONS AND AUTHENTICATION\n#------------------------------------------------------------------------------\n\n#
    - Connection Settings -\n\nlisten_addresses = '*'\n\t\t\t\t\t# comma-separated list
    of addresses;\n\t\t\t\t\t# defaults to 'localhost'; use '*' for all\n\t\t\t\t\t#
    (change requires restart)\n#port = 5432\t\t\t\t# (change requires restart)\nmax_connections
    = 100\t\t\t# (change requires restart)\n#superuser_reserved_connections = 3\t# (change
    requires restart)\n#unix_socket_directories = '/var/run/postgresql'\t# comma-separated
    list of directories\n\t\t\t\t\t# (change requires restart)\n#unix_socket_group =
    ''\t\t\t# (change requires restart)\n#unix_socket_permissions = 0777\t\t# begin
    with 0 to use octal notation\n\t\t\t\t\t# (change requires restart)\n#bonjour =
    off\t\t\t\t# advertise server via Bonjour\n\t\t\t\t\t# (change requires restart)\n#bonjour_name
    = ''\t\t\t# defaults to the computer name\n\t\t\t\t\t# (change requires restart)\n\n#
    - Security and Authentication -\n\n#authentication_timeout = 1min\t\t# 1s-600s\n#ssl
    = off\n#ssl_ciphers = 'HIGH:MEDIUM:+3DES:!aNULL' # allowed SSL ciphers\n#ssl_prefer_server_ciphers
    = on\n#ssl_ecdh_curve = 'prime256v1'\n#ssl_dh_params_file = ''\n#ssl_cert_file =
    'server.crt'\n#ssl_key_file = 'server.key'\n#ssl_ca_file = ''\n#ssl_crl_file = ''\n#password_encryption
    = md5\t\t# md5 or scram-sha-256\n#db_user_namespace = off\n#row_security = on\n\n#
    GSSAPI using Kerberos\n#krb_server_keyfile = ''\n#krb_caseins_users = off\n\n# -
    TCP Keepalives -\n# see \"man 7 tcp\" for details\n\n#tcp_keepalives_idle = 0\t\t#
    TCP_KEEPIDLE, in seconds;\n\t\t\t\t\t# 0 selects the system default\n#tcp_keepalives_interval
    = 0\t\t# TCP_KEEPINTVL, in seconds;\n\t\t\t\t\t# 0 selects the system default\n#tcp_keepalives_count
    = 0\t\t# TCP_KEEPCNT;\n\t\t\t\t\t# 0 selects the system default\n\n\n#------------------------------------------------------------------------------\n#
    RESOURCE USAGE (except WAL)\n#------------------------------------------------------------------------------\n\n#
    - Memory -\n\nshared_buffers = 128MB\t\t\t# min 128kB\n\t\t\t\t\t# (change requires
    restart)\n#huge_pages = try\t\t\t# on, off, or try\n\t\t\t\t\t# (change requires
    restart)\n#temp_buffers = 8MB\t\t\t# min 800kB\n#max_prepared_transactions = 0\t\t#
    zero disables the feature\n\t\t\t\t\t# (change requires restart)\n# Caution: it
    is not advisable to set max_prepared_transactions nonzero unless\n# you actively
    intend to use prepared transactions.\n#work_mem = 4MB\t\t\t\t# min 64kB\n#maintenance_work_mem
    = 64MB\t\t# min 1MB\n#replacement_sort_tuples = 150000\t# limits use of replacement
    selection sort\n#autovacuum_work_mem = -1\t\t# min 1MB, or -1 to use maintenance_work_mem\n#max_stack_depth
    = 2MB\t\t\t# min 100kB\ndynamic_shared_memory_type = posix\t# the default is the
    first option\n\t\t\t\t\t# supported by the operating system:\n\t\t\t\t\t#   posix\n\t\t\t\t\t#
    \  sysv\n\t\t\t\t\t#   windows\n\t\t\t\t\t#   mmap\n\t\t\t\t\t# use none to disable
    dynamic shared memory\n\t\t\t\t\t# (change requires restart)\n\n# - Disk -\n\n#temp_file_limit
    = -1\t\t\t# limits per-process temp file space\n\t\t\t\t\t# in kB, or -1 for no
    limit\n\n# - Kernel Resource Usage -\n\n#max_files_per_process = 1000\t\t# min 25\n\t\t\t\t\t#
    (change requires restart)\n#shared_preload_libraries = ''\t\t# (change requires
    restart)\n\n# - Cost-Based Vacuum Delay -\n\n#vacuum_cost_delay = 0\t\t\t# 0-100
    milliseconds\n#vacuum_cost_page_hit = 1\t\t# 0-10000 credits\n#vacuum_cost_page_miss
    = 10\t\t# 0-10000 credits\n#vacuum_cost_page_dirty = 20\t\t# 0-10000 credits\n#vacuum_cost_limit
    = 200\t\t# 1-10000 credits\n\n# - Background Writer -\n\n#bgwriter_delay = 200ms\t\t\t#
    10-10000ms between rounds\n#bgwriter_lru_maxpages = 100\t\t# 0-1000 max buffers
    written/round\n#bgwriter_lru_multiplier = 2.0\t\t# 0-10.0 multiplier on buffers
    scanned/round\n#bgwriter_flush_after = 512kB\t\t# measured in pages, 0 disables\n\n#
    - Asynchronous Behavior -\n\n#effective_io_concurrency = 1\t\t# 1-1000; 0 disables
    prefetching\n#max_worker_processes = 8\t\t# (change requires restart)\n#max_parallel_workers_per_gather
    = 2\t# taken from max_parallel_workers\n#max_parallel_workers = 8\t\t# maximum number
    of max_worker_processes that\n\t\t\t\t\t# can be used in parallel queries\n#old_snapshot_threshold
    = -1\t\t# 1min-60d; -1 disables; 0 is immediate\n\t\t\t\t\t# (change requires restart)\n#backend_flush_after
    = 0\t\t# measured in pages, 0 disables\n\n\n#------------------------------------------------------------------------------\n#
    WRITE AHEAD LOG\n#------------------------------------------------------------------------------\n\n#
    - Settings -\n\n#wal_level = replica\t\t\t# minimal, replica, or logical\n\t\t\t\t\t#
    (change requires restart)\n#fsync = on\t\t\t\t# flush data to disk for crash safety\n\t\t\t\t\t#
    (turning this off can cause\n\t\t\t\t\t# unrecoverable data corruption)\n#synchronous_commit
    = on\t\t# synchronization level;\n\t\t\t\t\t# off, local, remote_write, remote_apply,
    or on\n#wal_sync_method = fsync\t\t# the default is the first option\n\t\t\t\t\t#
    supported by the operating system:\n\t\t\t\t\t#   open_datasync\n\t\t\t\t\t#   fdatasync
    (default on Linux and FreeBSD)\n\t\t\t\t\t#   fsync\n\t\t\t\t\t#   fsync_writethrough\n\t\t\t\t\t#
    \  open_sync\n#full_page_writes = on\t\t\t# recover from partial page writes\n#wal_compression
    = off\t\t\t# enable compression of full-page writes\n#wal_log_hints = off\t\t\t#
    also do full page writes of non-critical updates\n\t\t\t\t\t# (change requires restart)\n#wal_buffers
    = -1\t\t\t# min 32kB, -1 sets based on shared_buffers\n\t\t\t\t\t# (change requires
    restart)\n#wal_writer_delay = 200ms\t\t# 1-10000 milliseconds\n#wal_writer_flush_after
    = 1MB\t\t# measured in pages, 0 disables\n\n#commit_delay = 0\t\t\t# range 0-100000,
    in microseconds\n#commit_siblings = 5\t\t\t# range 1-1000\n\n# - Checkpoints -\n\n#checkpoint_timeout
    = 5min\t\t# range 30s-1d\n#max_wal_size = 1GB\n#min_wal_size = 80MB\n#checkpoint_completion_target
    = 0.5\t# checkpoint target duration, 0.0 - 1.0\n#checkpoint_flush_after = 256kB\t\t#
    measured in pages, 0 disables\n#checkpoint_warning = 30s\t\t# 0 disables\n\n# -
    Archiving -\n\n#archive_mode = off\t\t# enables archiving; off, on, or always\n\t\t\t\t#
    (change requires restart)\n#archive_command = ''\t\t# command to use to archive
    a logfile segment\n\t\t\t\t# placeholders: %p = path of file to archive\n\t\t\t\t#
    \              %f = file name only\n\t\t\t\t# e.g. 'test ! -f /mnt/server/archivedir/%f
    && cp %p /mnt/server/archivedir/%f'\n#archive_timeout = 0\t\t# force a logfile segment
    switch after this\n\t\t\t\t# number of seconds; 0 disables\n\n\n#------------------------------------------------------------------------------\n#
    REPLICATION\n#------------------------------------------------------------------------------\n\nwal_level
    = replica\nmax_wal_senders = 2\nmax_replication_slots = 2\nsynchronous_commit =
    off\n\n# - Sending Server(s) -\n\n# Set these on the master and on any standby that
    will send replication data.\n\n#max_wal_senders = 10\t\t# max number of walsender
    processes\n\t\t\t\t# (change requires restart)\n#wal_keep_segments = 0\t\t# in logfile
    segments, 16MB each; 0 disables\n#wal_sender_timeout = 60s\t# in milliseconds; 0
    disables\n\n#max_replication_slots = 10\t# max number of replication slots\n\t\t\t\t#
    (change requires restart)\n#track_commit_timestamp = off\t# collect timestamp of
    transaction commit\n\t\t\t\t# (change requires restart)\n\n# - Master Server -\n\n#
    These settings are ignored on a standby server.\n\n#synchronous_standby_names =
    ''\t# standby servers that provide sync rep\n\t\t\t\t# method to choose sync standbys,
    number of sync standbys,\n\t\t\t\t# and comma-separated list of application_name\n\t\t\t\t#
    from standby(s); '*' = all\n#vacuum_defer_cleanup_age = 0\t# number of xacts by
    which cleanup is delayed\n\n# - Standby Servers -\n\n# These settings are ignored
    on a master server.\n\n#hot_standby = on\t\t\t# \"off\" disallows queries during
    recovery\n\t\t\t\t\t# (change requires restart)\n#max_standby_archive_delay = 30s\t#
    max delay before canceling queries\n\t\t\t\t\t# when reading WAL from archive;\n\t\t\t\t\t#
    -1 allows indefinite delay\n#max_standby_streaming_delay = 30s\t# max delay before
    canceling queries\n\t\t\t\t\t# when reading streaming WAL;\n\t\t\t\t\t# -1 allows
    indefinite delay\n#wal_receiver_status_interval = 10s\t# send replies at least this
    often\n\t\t\t\t\t# 0 disables\n#hot_standby_feedback = off\t\t# send info from standby
    to prevent\n\t\t\t\t\t# query conflicts\n#wal_receiver_timeout = 60s\t\t# time that
    receiver waits for\n\t\t\t\t\t# communication from master\n\t\t\t\t\t# in milliseconds;
    0 disables\n#wal_retrieve_retry_interval = 5s\t# time to wait before retrying to\n\t\t\t\t\t#
    retrieve WAL after a failed attempt\n\n# - Subscribers -\n\n# These settings are
    ignored on a publisher.\n\n#max_logical_replication_workers = 4\t# taken from max_worker_processes\n\t\t\t\t\t#
    (change requires restart)\n#max_sync_workers_per_subscription = 2\t# taken from
    max_logical_replication_workers\n\n\n#------------------------------------------------------------------------------\n#
    QUERY TUNING\n#------------------------------------------------------------------------------\n\n#
    - Planner Method Configuration -\n\n#enable_bitmapscan = on\n#enable_hashagg = on\n#enable_hashjoin
    = on\n#enable_indexscan = on\n#enable_indexonlyscan = on\n#enable_material = on\n#enable_mergejoin
    = on\n#enable_nestloop = on\n#enable_seqscan = on\n#enable_sort = on\n#enable_tidscan
    = on\n\n# - Planner Cost Constants -\n\n#seq_page_cost = 1.0\t\t\t# measured on
    an arbitrary scale\n#random_page_cost = 4.0\t\t\t# same scale as above\n#cpu_tuple_cost
    = 0.01\t\t\t# same scale as above\n#cpu_index_tuple_cost = 0.005\t\t# same scale
    as above\n#cpu_operator_cost = 0.0025\t\t# same scale as above\n#parallel_tuple_cost
    = 0.1\t\t# same scale as above\n#parallel_setup_cost = 1000.0\t# same scale as above\n#min_parallel_table_scan_size
    = 8MB\n#min_parallel_index_scan_size = 512kB\n#effective_cache_size = 4GB\n\n# -
    Genetic Query Optimizer -\n\n#geqo = on\n#geqo_threshold = 12\n#geqo_effort = 5\t\t\t#
    range 1-10\n#geqo_pool_size = 0\t\t\t# selects default based on effort\n#geqo_generations
    = 0\t\t\t# selects default based on effort\n#geqo_selection_bias = 2.0\t\t# range
    1.5-2.0\n#geqo_seed = 0.0\t\t\t# range 0.0-1.0\n\n# - Other Planner Options -\n\n#default_statistics_target
    = 100\t# range 1-10000\n#constraint_exclusion = partition\t# on, off, or partition\n#cursor_tuple_fraction
    = 0.1\t\t# range 0.0-1.0\n#from_collapse_limit = 8\n#join_collapse_limit = 8\t\t#
    1 disables collapsing of explicit\n\t\t\t\t\t# JOIN clauses\n#force_parallel_mode
    = off\n\n\n#------------------------------------------------------------------------------\n#
    ERROR REPORTING AND LOGGING\n#------------------------------------------------------------------------------\n\n#
    - Where to Log -\n\n#log_destination = 'stderr'\t\t# Valid values are combinations
    of\n\t\t\t\t\t# stderr, csvlog, syslog, and eventlog,\n\t\t\t\t\t# depending on
    platform.  csvlog\n\t\t\t\t\t# requires logging_collector to be on.\n\n# This is
    used when logging to stderr:\n#logging_collector = off\t\t# Enable capturing of
    stderr and csvlog\n\t\t\t\t\t# into log files. Required to be on for\n\t\t\t\t\t#
    csvlogs.\n\t\t\t\t\t# (change requires restart)\n\n# These are only used if logging_collector
    is on:\n#log_directory = 'log'\t\t\t# directory where log files are written,\n\t\t\t\t\t#
    can be absolute or relative to PGDATA\n#log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'\t#
    log file name pattern,\n\t\t\t\t\t# can include strftime() escapes\n#log_file_mode
    = 0600\t\t\t# creation mode for log files,\n\t\t\t\t\t# begin with 0 to use octal
    notation\n#log_truncate_on_rotation = off\t\t# If on, an existing log file with
    the\n\t\t\t\t\t# same name as the new log file will be\n\t\t\t\t\t# truncated rather
    than appended to.\n\t\t\t\t\t# But such truncation only occurs on\n\t\t\t\t\t# time-driven
    rotation, not on restarts\n\t\t\t\t\t# or size-driven rotation.  Default is\n\t\t\t\t\t#
    off, meaning append to existing files\n\t\t\t\t\t# in all cases.\n#log_rotation_age
    = 1d\t\t\t# Automatic rotation of logfiles will\n\t\t\t\t\t# happen after that time.
    \ 0 disables.\n#log_rotation_size = 10MB\t\t# Automatic rotation of logfiles will\n\t\t\t\t\t#
    happen after that much log output.\n\t\t\t\t\t# 0 disables.\n\n# These are relevant
    when logging to syslog:\n#syslog_facility = 'LOCAL0'\n#syslog_ident = 'postgres'\n#syslog_sequence_numbers
    = on\n#syslog_split_messages = on\n\n# This is only relevant when logging to eventlog
    (win32):\n# (change requires restart)\n#event_source = 'PostgreSQL'\n\n# - When
    to Log -\n\n#log_min_messages = warning\t\t# values in order of decreasing detail:\n\t\t\t\t\t#
    \  debug5\n\t\t\t\t\t#   debug4\n\t\t\t\t\t#   debug3\n\t\t\t\t\t#   debug2\n\t\t\t\t\t#
    \  debug1\n\t\t\t\t\t#   info\n\t\t\t\t\t#   notice\n\t\t\t\t\t#   warning\n\t\t\t\t\t#
    \  error\n\t\t\t\t\t#   log\n\t\t\t\t\t#   fatal\n\t\t\t\t\t#   panic\n\n#log_min_error_statement
    = error\t# values in order of decreasing detail:\n\t\t\t\t\t#   debug5\n\t\t\t\t\t#
    \  debug4\n\t\t\t\t\t#   debug3\n\t\t\t\t\t#   debug2\n\t\t\t\t\t#   debug1\n\t\t\t\t\t#
    \  info\n\t\t\t\t\t#   notice\n\t\t\t\t\t#   warning\n\t\t\t\t\t#   error\n\t\t\t\t\t#
    \  log\n\t\t\t\t\t#   fatal\n\t\t\t\t\t#   panic (effectively off)\n\n#log_min_duration_statement
    = -1\t# -1 is disabled, 0 logs all statements\n\t\t\t\t\t# and their durations,
    > 0 logs only\n\t\t\t\t\t# statements running at least this number\n\t\t\t\t\t#
    of milliseconds\n\n\n# - What to Log -\n\n#debug_print_parse = off\n#debug_print_rewritten
    = off\n#debug_print_plan = off\n#debug_pretty_print = on\n#log_checkpoints = off\n#log_connections
    = off\n#log_disconnections = off\n#log_duration = off\n#log_error_verbosity = default\t\t#
    terse, default, or verbose messages\n#log_hostname = off\n#log_line_prefix = '%m
    [%p] '\t\t# special values:\n\t\t\t\t\t#   %a = application name\n\t\t\t\t\t#   %u
    = user name\n\t\t\t\t\t#   %d = database name\n\t\t\t\t\t#   %r = remote host and
    port\n\t\t\t\t\t#   %h = remote host\n\t\t\t\t\t#   %p = process ID\n\t\t\t\t\t#
    \  %t = timestamp without milliseconds\n\t\t\t\t\t#   %m = timestamp with milliseconds\n\t\t\t\t\t#
    \  %n = timestamp with milliseconds (as a Unix epoch)\n\t\t\t\t\t#   %i = command
    tag\n\t\t\t\t\t#   %e = SQL state\n\t\t\t\t\t#   %c = session ID\n\t\t\t\t\t#   %l
    = session line number\n\t\t\t\t\t#   %s = session start timestamp\n\t\t\t\t\t#   %v
    = virtual transaction ID\n\t\t\t\t\t#   %x = transaction ID (0 if none)\n\t\t\t\t\t#
    \  %q = stop here in non-session\n\t\t\t\t\t#        processes\n\t\t\t\t\t#   %%
    = '%'\n\t\t\t\t\t# e.g. '<%u%%%d> '\n#log_lock_waits = off\t\t\t# log lock waits
    >= deadlock_timeout\n#log_statement = 'none'\t\t\t# none, ddl, mod, all\n#log_replication_commands
    = off\n#log_temp_files = -1\t\t\t# log temporary files equal or larger\n\t\t\t\t\t#
    than the specified size in kilobytes;\n\t\t\t\t\t# -1 disables, 0 logs all temp
    files\nlog_timezone = 'Etc/UTC'\n\n\n# - Process Title -\n\n#cluster_name = ''\t\t\t#
    added to process titles if nonempty\n\t\t\t\t\t# (change requires restart)\n#update_process_title
    = on\n\n\n#------------------------------------------------------------------------------\n#
    RUNTIME STATISTICS\n#------------------------------------------------------------------------------\n\n#
    - Query/Index Statistics Collector -\n\n#track_activities = on\n#track_counts =
    on\n#track_io_timing = off\n#track_functions = none\t\t\t# none, pl, all\n#track_activity_query_size
    = 1024\t# (change requires restart)\n#stats_temp_directory = 'pg_stat_tmp'\n\n\n#
    - Statistics Monitoring -\n\n#log_parser_stats = off\n#log_planner_stats = off\n#log_executor_stats
    = off\n#log_statement_stats = off\n\n\n#------------------------------------------------------------------------------\n#
    AUTOVACUUM PARAMETERS\n#------------------------------------------------------------------------------\n\n#autovacuum
    = on\t\t\t# Enable autovacuum subprocess?  'on'\n\t\t\t\t\t# requires track_counts
    to also be on.\n#log_autovacuum_min_duration = -1\t# -1 disables, 0 logs all actions
    and\n\t\t\t\t\t# their durations, > 0 logs only\n\t\t\t\t\t# actions running at
    least this number\n\t\t\t\t\t# of milliseconds.\n#autovacuum_max_workers = 3\t\t#
    max number of autovacuum subprocesses\n\t\t\t\t\t# (change requires restart)\n#autovacuum_naptime
    = 1min\t\t# time between autovacuum runs\n#autovacuum_vacuum_threshold = 50\t# min
    number of row updates before\n\t\t\t\t\t# vacuum\n#autovacuum_analyze_threshold
    = 50\t# min number of row updates before\n\t\t\t\t\t# analyze\n#autovacuum_vacuum_scale_factor
    = 0.2\t# fraction of table size before vacuum\n#autovacuum_analyze_scale_factor
    = 0.1\t# fraction of table size before analyze\n#autovacuum_freeze_max_age = 200000000\t#
    maximum XID age before forced vacuum\n\t\t\t\t\t# (change requires restart)\n#autovacuum_multixact_freeze_max_age
    = 400000000\t# maximum multixact age\n\t\t\t\t\t# before forced vacuum\n\t\t\t\t\t#
    (change requires restart)\n#autovacuum_vacuum_cost_delay = 20ms\t# default vacuum
    cost delay for\n\t\t\t\t\t# autovacuum, in milliseconds;\n\t\t\t\t\t# -1 means use
    vacuum_cost_delay\n#autovacuum_vacuum_cost_limit = -1\t# default vacuum cost limit
    for\n\t\t\t\t\t# autovacuum, -1 means use\n\t\t\t\t\t# vacuum_cost_limit\n\n\n#------------------------------------------------------------------------------\n#
    CLIENT CONNECTION DEFAULTS\n#------------------------------------------------------------------------------\n\n#
    - Statement Behavior -\n\n#client_min_messages = notice\t\t# values in order of
    decreasing detail:\n\t\t\t\t\t#   debug5\n\t\t\t\t\t#   debug4\n\t\t\t\t\t#   debug3\n\t\t\t\t\t#
    \  debug2\n\t\t\t\t\t#   debug1\n\t\t\t\t\t#   log\n\t\t\t\t\t#   notice\n\t\t\t\t\t#
    \  warning\n\t\t\t\t\t#   error\n#search_path = '\"$user\", public'\t# schema names\n#default_tablespace
    = ''\t\t# a tablespace name, '' uses the default\n#temp_tablespaces = ''\t\t\t#
    a list of tablespace names, '' uses\n\t\t\t\t\t# only default tablespace\n#check_function_bodies
    = on\n#default_transaction_isolation = 'read committed'\n#default_transaction_read_only
    = off\n#default_transaction_deferrable = off\n#session_replication_role = 'origin'\n#statement_timeout
    = 0\t\t\t# in milliseconds, 0 is disabled\n#lock_timeout = 0\t\t\t# in milliseconds,
    0 is disabled\n#idle_in_transaction_session_timeout = 0\t# in milliseconds, 0 is
    disabled\n#vacuum_freeze_min_age = 50000000\n#vacuum_freeze_table_age = 150000000\n#vacuum_multixact_freeze_min_age
    = 5000000\n#vacuum_multixact_freeze_table_age = 150000000\n#bytea_output = 'hex'\t\t\t#
    hex, escape\n#xmlbinary = 'base64'\n#xmloption = 'content'\n#gin_fuzzy_search_limit
    = 0\n#gin_pending_list_limit = 4MB\n\n# - Locale and Formatting -\n\ndatestyle =
    'iso, mdy'\n#intervalstyle = 'postgres'\ntimezone = 'Etc/UTC'\n#timezone_abbreviations
    = 'Default'     # Select the set of available time zone\n\t\t\t\t\t# abbreviations.
    \ Currently, there are\n\t\t\t\t\t#   Default\n\t\t\t\t\t#   Australia (historical
    usage)\n\t\t\t\t\t#   India\n\t\t\t\t\t# You can create your own file in\n\t\t\t\t\t#
    share/timezonesets/.\n#extra_float_digits = 0\t\t\t# min -15, max 3\n#client_encoding
    = sql_ascii\t\t# actually, defaults to database\n\t\t\t\t\t# encoding\n\n# These
    settings are initialized by initdb, but they can be changed.\nlc_messages = 'en_US.utf8'\t\t\t#
    locale for system error message\n\t\t\t\t\t# strings\nlc_monetary = 'en_US.utf8'\t\t\t#
    locale for monetary formatting\nlc_numeric = 'en_US.utf8'\t\t\t# locale for number
    formatting\nlc_time = 'en_US.utf8'\t\t\t\t# locale for time formatting\n\n# default
    configuration for text search\ndefault_text_search_config = 'pg_catalog.english'\n\n#
    - Other Defaults -\n\n#dynamic_library_path = '$libdir'\n#extension_destdir = ''\t\t\t#
    prepend path when loading extensions\n\t\t\t\t\t# and shared objects (added by Debian)\n#local_preload_libraries
    = ''\n#session_preload_libraries = ''\n\n\n#------------------------------------------------------------------------------\n#
    LOCK MANAGEMENT\n#------------------------------------------------------------------------------\n\n#deadlock_timeout
    = 1s\n#max_locks_per_transaction = 64\t\t# min 10\n\t\t\t\t\t# (change requires
    restart)\n#max_pred_locks_per_transaction = 64\t# min 10\n\t\t\t\t\t# (change requires
    restart)\n#max_pred_locks_per_relation = -2\t# negative values mean\n\t\t\t\t\t#
    (max_pred_locks_per_transaction\n\t\t\t\t\t#  / -max_pred_locks_per_relation) -
    1\n#max_pred_locks_per_page = 2            # min 0\n\n\n#------------------------------------------------------------------------------\n#
    VERSION/PLATFORM COMPATIBILITY\n#------------------------------------------------------------------------------\n\n#
    - Previous PostgreSQL Versions -\n\n#array_nulls = on\n#backslash_quote = safe_encoding\t#
    on, off, or safe_encoding\n#default_with_oids = off\n#escape_string_warning = on\n#lo_compat_privileges
    = off\n#operator_precedence_warning = off\n#quote_all_identifiers = off\n#standard_conforming_strings
    = on\n#synchronize_seqscans = on\n\n# - Other Platforms and Clients -\n\n#transform_null_equals
    = off\n\n\n#------------------------------------------------------------------------------\n#
    ERROR HANDLING\n#------------------------------------------------------------------------------\n\n#exit_on_error
    = off\t\t\t# terminate session on any error?\n#restart_after_crash = on\t\t# reinitialize
    after backend crash?\n#data_sync_retry = off\t\t\t# retry or panic on failure to
    fsync\n\t\t\t\t\t# data?\n\t\t\t\t\t# (change requires restart)\n\n\n#------------------------------------------------------------------------------\n#
    CONFIG FILE INCLUDES\n#------------------------------------------------------------------------------\n\n#
    These options allow settings to be loaded from files other than the\n# default postgresql.conf.
    \ Note that these are directives, not variable\n# assignments, so they can usefully
    be given more than once.\n\n#include_dir = '...'\t\t\t# include files ending in
    '.conf' from\n\t\t\t\t\t# a directory, e.g., 'conf.d'\n#include_if_exists = '...'\t\t#
    include file only if it exists\n#include = '...'\t\t\t# include file\n\n\n#------------------------------------------------------------------------------\n#
    CUSTOMIZED OPTIONS\n#------------------------------------------------------------------------------\n\n#
    Add settings for extensions here\n"
---
# Source: python-web-app/charts/pythonapp/templates/configmaps.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: my-config
  namespace: python-app
data:
  config.yaml: |-
    params:
      local_servers: "True"
      local_uric: "postgresql://admin:Knit168412@primarydb-svc:5432/python-app"
      local_uri: "postgresql://admin:Knit168412@primarydb-svc:5432/python-app"
      prod_uri: "mysql://root:Knit168412@localhost/codingthunder"
      fb_uri: "https://www.facebook.com/shashank30mishra/"
      gh_uri: "https://github.com/168412/shawshank"
      tw_uri: "https://twitter.com/Shashan51491868"
      mail_id: "fzd224161@gmail.com"
      psswd: "Knit"
      about_txt: "Hi my name is shawshank and I am an Engineer."
      no_post: 2
      copyright: "Coding Thunder"
      login_img: "login.svg"
      admin_name: "fzd224161@gmail.com"
      admin_psswd: "12345"
      file_location: "static/assets/img"
      file_format: "{'png', 'jpg', 'jpeg', 'gif'}"
---
# Source: python-web-app/charts/readreplica/templates/configmaps.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: release-name-configmap-sb
  namespace: python-app
data:
  postgresql.conf: "# -----------------------------\r\n# PostgreSQL configuration file\r\n#
    -----------------------------\r\n#\r\n# This file consists of lines of the form:\r\n#\r\n#
    \  name = value\r\n#\r\n# (The \"=\" is optional.)  Whitespace may be used.  Comments
    are introduced with\r\n# \"#\" anywhere on a line.  The complete list of parameter
    names and allowed\r\n# values can be found in the PostgreSQL documentation.\r\n#\r\n#
    The commented-out settings shown in this file represent the default values.\r\n#
    Re-commenting a setting is NOT sufficient to revert it to the default value;\r\n#
    you need to reload the server.\r\n#\r\n# This file is read on server startup and
    when the server receives a SIGHUP\r\n# signal.  If you edit the file on a running
    system, you have to SIGHUP the\r\n# server for the changes to take effect, run \"pg_ctl
    reload\", or execute\r\n# \"SELECT pg_reload_conf()\".  Some parameters, which are
    marked below,\r\n# require a server shutdown and restart to take effect.\r\n#\r\n#
    Any parameter can also be given as a command-line option to the server, e.g.,\r\n#
    \"postgres -c log_connections=on\".  Some parameters can be changed at run time\r\n#
    with the \"SET\" SQL command.\r\n#\r\n# Memory units:  kB = kilobytes        Time
    units:  ms  = milliseconds\r\n#                MB = megabytes                     s
    \  = seconds\r\n#                GB = gigabytes                     min = minutes\r\n#
    \               TB = terabytes                     h   = hours\r\n#                                                   d
    \  = days\r\n\r\n\r\n#------------------------------------------------------------------------------\r\n#
    FILE LOCATIONS\r\n#------------------------------------------------------------------------------\r\n\r\n#
    The default values of these variables are driven from the -D command-line\r\n# option
    or PGDATA environment variable, represented here as ConfigDir.\r\n\r\n#data_directory
    = 'ConfigDir'\t\t# use data in another directory\r\n\t\t\t\t\t# (change requires
    restart)\r\n#hba_file = 'ConfigDir/pg_hba.conf'\t# host-based authentication file\r\n\t\t\t\t\t#
    (change requires restart)\r\n#ident_file = 'ConfigDir/pg_ident.conf'\t# ident configuration
    file\r\n\t\t\t\t\t# (change requires restart)\r\n\r\n# If external_pid_file is not
    explicitly set, no extra PID file is written.\r\n#external_pid_file = ''\t\t\t#
    write an extra PID file\r\n\t\t\t\t\t# (change requires restart)\r\n\r\n\r\n#------------------------------------------------------------------------------\r\n#
    CONNECTIONS AND AUTHENTICATION\r\n#------------------------------------------------------------------------------\r\n\r\n#
    - Connection Settings -\r\n\r\nlisten_addresses = '*'\r\n\t\t\t\t\t# comma-separated
    list of addresses;\r\n\t\t\t\t\t# defaults to 'localhost'; use '*' for all\r\n\t\t\t\t\t#
    (change requires restart)\r\n#port = 5432\t\t\t\t# (change requires restart)\r\nmax_connections
    = 100\t\t\t# (change requires restart)\r\n#superuser_reserved_connections = 3\t#
    (change requires restart)\r\n#unix_socket_directories = '/var/run/postgresql'\t#
    comma-separated list of directories\r\n\t\t\t\t\t# (change requires restart)\r\n#unix_socket_group
    = ''\t\t\t# (change requires restart)\r\n#unix_socket_permissions = 0777\t\t# begin
    with 0 to use octal notation\r\n\t\t\t\t\t# (change requires restart)\r\n#bonjour
    = off\t\t\t\t# advertise server via Bonjour\r\n\t\t\t\t\t# (change requires restart)\r\n#bonjour_name
    = ''\t\t\t# defaults to the computer name\r\n\t\t\t\t\t# (change requires restart)\r\n\r\n#
    - Security and Authentication -\r\n\r\n#authentication_timeout = 1min\t\t# 1s-600s\r\n#ssl
    = off\r\n#ssl_ciphers = 'HIGH:MEDIUM:+3DES:!aNULL' # allowed SSL ciphers\r\n#ssl_prefer_server_ciphers
    = on\r\n#ssl_ecdh_curve = 'prime256v1'\r\n#ssl_dh_params_file = ''\r\n#ssl_cert_file
    = 'server.crt'\r\n#ssl_key_file = 'server.key'\r\n#ssl_ca_file = ''\r\n#ssl_crl_file
    = ''\r\n#password_encryption = md5\t\t# md5 or scram-sha-256\r\n#db_user_namespace
    = off\r\n#row_security = on\r\n\r\n# GSSAPI using Kerberos\r\n#krb_server_keyfile
    = ''\r\n#krb_caseins_users = off\r\n\r\n# - TCP Keepalives -\r\n# see \"man 7 tcp\"
    for details\r\n\r\n#tcp_keepalives_idle = 0\t\t# TCP_KEEPIDLE, in seconds;\r\n\t\t\t\t\t#
    0 selects the system default\r\n#tcp_keepalives_interval = 0\t\t# TCP_KEEPINTVL,
    in seconds;\r\n\t\t\t\t\t# 0 selects the system default\r\n#tcp_keepalives_count
    = 0\t\t# TCP_KEEPCNT;\r\n\t\t\t\t\t# 0 selects the system default\r\n\r\n\r\n#------------------------------------------------------------------------------\r\n#
    RESOURCE USAGE (except WAL)\r\n#------------------------------------------------------------------------------\r\n\r\n#
    - Memory -\r\n\r\nshared_buffers = 128MB\t\t\t# min 128kB\r\n\t\t\t\t\t# (change
    requires restart)\r\n#huge_pages = try\t\t\t# on, off, or try\r\n\t\t\t\t\t# (change
    requires restart)\r\n#temp_buffers = 8MB\t\t\t# min 800kB\r\n#max_prepared_transactions
    = 0\t\t# zero disables the feature\r\n\t\t\t\t\t# (change requires restart)\r\n#
    Caution: it is not advisable to set max_prepared_transactions nonzero unless\r\n#
    you actively intend to use prepared transactions.\r\n#work_mem = 4MB\t\t\t\t# min
    64kB\r\n#maintenance_work_mem = 64MB\t\t# min 1MB\r\n#replacement_sort_tuples =
    150000\t# limits use of replacement selection sort\r\n#autovacuum_work_mem = -1\t\t#
    min 1MB, or -1 to use maintenance_work_mem\r\n#max_stack_depth = 2MB\t\t\t# min
    100kB\r\ndynamic_shared_memory_type = posix\t# the default is the first option\r\n\t\t\t\t\t#
    supported by the operating system:\r\n\t\t\t\t\t#   posix\r\n\t\t\t\t\t#   sysv\r\n\t\t\t\t\t#
    \  windows\r\n\t\t\t\t\t#   mmap\r\n\t\t\t\t\t# use none to disable dynamic shared
    memory\r\n\t\t\t\t\t# (change requires restart)\r\n\r\n# - Disk -\r\n\r\n#temp_file_limit
    = -1\t\t\t# limits per-process temp file space\r\n\t\t\t\t\t# in kB, or -1 for no
    limit\r\n\r\n# - Kernel Resource Usage -\r\n\r\n#max_files_per_process = 1000\t\t#
    min 25\r\n\t\t\t\t\t# (change requires restart)\r\n#shared_preload_libraries = ''\t\t#
    (change requires restart)\r\n\r\n# - Cost-Based Vacuum Delay -\r\n\r\n#vacuum_cost_delay
    = 0\t\t\t# 0-100 milliseconds\r\n#vacuum_cost_page_hit = 1\t\t# 0-10000 credits\r\n#vacuum_cost_page_miss
    = 10\t\t# 0-10000 credits\r\n#vacuum_cost_page_dirty = 20\t\t# 0-10000 credits\r\n#vacuum_cost_limit
    = 200\t\t# 1-10000 credits\r\n\r\n# - Background Writer -\r\n\r\n#bgwriter_delay
    = 200ms\t\t\t# 10-10000ms between rounds\r\n#bgwriter_lru_maxpages = 100\t\t# 0-1000
    max buffers written/round\r\n#bgwriter_lru_multiplier = 2.0\t\t# 0-10.0 multiplier
    on buffers scanned/round\r\n#bgwriter_flush_after = 512kB\t\t# measured in pages,
    0 disables\r\n\r\n# - Asynchronous Behavior -\r\n\r\n#effective_io_concurrency =
    1\t\t# 1-1000; 0 disables prefetching\r\n#max_worker_processes = 8\t\t# (change
    requires restart)\r\n#max_parallel_workers_per_gather = 2\t# taken from max_parallel_workers\r\n#max_parallel_workers
    = 8\t\t# maximum number of max_worker_processes that\r\n\t\t\t\t\t# can be used
    in parallel queries\r\n#old_snapshot_threshold = -1\t\t# 1min-60d; -1 disables;
    0 is immediate\r\n\t\t\t\t\t# (change requires restart)\r\n#backend_flush_after
    = 0\t\t# measured in pages, 0 disables\r\n\r\n\r\n#------------------------------------------------------------------------------\r\n#
    WRITE AHEAD LOG\r\n#------------------------------------------------------------------------------\r\n\r\n#
    - Settings -\r\n\r\n#wal_level = replica\t\t\t# minimal, replica, or logical\r\n\t\t\t\t\t#
    (change requires restart)\r\n#fsync = on\t\t\t\t# flush data to disk for crash safety\r\n\t\t\t\t\t#
    (turning this off can cause\r\n\t\t\t\t\t# unrecoverable data corruption)\r\n#synchronous_commit
    = on\t\t# synchronization level;\r\n\t\t\t\t\t# off, local, remote_write, remote_apply,
    or on\r\n#wal_sync_method = fsync\t\t# the default is the first option\r\n\t\t\t\t\t#
    supported by the operating system:\r\n\t\t\t\t\t#   open_datasync\r\n\t\t\t\t\t#
    \  fdatasync (default on Linux and FreeBSD)\r\n\t\t\t\t\t#   fsync\r\n\t\t\t\t\t#
    \  fsync_writethrough\r\n\t\t\t\t\t#   open_sync\r\n#full_page_writes = on\t\t\t#
    recover from partial page writes\r\n#wal_compression = off\t\t\t# enable compression
    of full-page writes\r\n#wal_log_hints = off\t\t\t# also do full page writes of non-critical
    updates\r\n\t\t\t\t\t# (change requires restart)\r\n#wal_buffers = -1\t\t\t# min
    32kB, -1 sets based on shared_buffers\r\n\t\t\t\t\t# (change requires restart)\r\n#wal_writer_delay
    = 200ms\t\t# 1-10000 milliseconds\r\n#wal_writer_flush_after = 1MB\t\t# measured
    in pages, 0 disables\r\n\r\n#commit_delay = 0\t\t\t# range 0-100000, in microseconds\r\n#commit_siblings
    = 5\t\t\t# range 1-1000\r\n\r\n# - Checkpoints -\r\n\r\n#checkpoint_timeout = 5min\t\t#
    range 30s-1d\r\n#max_wal_size = 1GB\r\n#min_wal_size = 80MB\r\n#checkpoint_completion_target
    = 0.5\t# checkpoint target duration, 0.0 - 1.0\r\n#checkpoint_flush_after = 256kB\t\t#
    measured in pages, 0 disables\r\n#checkpoint_warning = 30s\t\t# 0 disables\r\n\r\n#
    - Archiving -\r\n\r\n#archive_mode = off\t\t# enables archiving; off, on, or always\r\n\t\t\t\t#
    (change requires restart)\r\n#archive_command = ''\t\t# command to use to archive
    a logfile segment\r\n\t\t\t\t# placeholders: %p = path of file to archive\r\n\t\t\t\t#
    \              %f = file name only\r\n\t\t\t\t# e.g. 'test ! -f /mnt/server/archivedir/%f
    && cp %p /mnt/server/archivedir/%f'\r\n#archive_timeout = 0\t\t# force a logfile
    segment switch after this\r\n\t\t\t\t# number of seconds; 0 disables\r\n\r\n\r\n#------------------------------------------------------------------------------\r\n#
    REPLICATION\r\n#------------------------------------------------------------------------------\r\n\r\nwal_level
    = replica\r\nmax_wal_senders = 2\r\nmax_replication_slots = 2\r\nsynchronous_commit
    = off\r\n\r\nhot_standby = on\r\nmax_replication_slots = 2\r\n# - Sending Server(s)
    -\r\n\r\n# Set these on the master and on any standby that will send replication
    data.\r\n\r\n#max_wal_senders = 10\t\t# max number of walsender processes\r\n\t\t\t\t#
    (change requires restart)\r\n#wal_keep_segments = 0\t\t# in logfile segments, 16MB
    each; 0 disables\r\n#wal_sender_timeout = 60s\t# in milliseconds; 0 disables\r\n\r\n#max_replication_slots
    = 10\t# max number of replication slots\r\n\t\t\t\t# (change requires restart)\r\n#track_commit_timestamp
    = off\t# collect timestamp of transaction commit\r\n\t\t\t\t# (change requires restart)\r\n\r\n#
    - Master Server -\r\n\r\n# These settings are ignored on a standby server.\r\n\r\n#synchronous_standby_names
    = ''\t# standby servers that provide sync rep\r\n\t\t\t\t# method to choose sync
    standbys, number of sync standbys,\r\n\t\t\t\t# and comma-separated list of application_name\r\n\t\t\t\t#
    from standby(s); '*' = all\r\n#vacuum_defer_cleanup_age = 0\t# number of xacts by
    which cleanup is delayed\r\n\r\n# - Standby Servers -\r\n\r\n# These settings are
    ignored on a master server.\r\n\r\n#hot_standby = on\t\t\t# \"off\" disallows queries
    during recovery\r\n\t\t\t\t\t# (change requires restart)\r\n#max_standby_archive_delay
    = 30s\t# max delay before canceling queries\r\n\t\t\t\t\t# when reading WAL from
    archive;\r\n\t\t\t\t\t# -1 allows indefinite delay\r\n#max_standby_streaming_delay
    = 30s\t# max delay before canceling queries\r\n\t\t\t\t\t# when reading streaming
    WAL;\r\n\t\t\t\t\t# -1 allows indefinite delay\r\n#wal_receiver_status_interval
    = 10s\t# send replies at least this often\r\n\t\t\t\t\t# 0 disables\r\n#hot_standby_feedback
    = off\t\t# send info from standby to prevent\r\n\t\t\t\t\t# query conflicts\r\n#wal_receiver_timeout
    = 60s\t\t# time that receiver waits for\r\n\t\t\t\t\t# communication from master\r\n\t\t\t\t\t#
    in milliseconds; 0 disables\r\n#wal_retrieve_retry_interval = 5s\t# time to wait
    before retrying to\r\n\t\t\t\t\t# retrieve WAL after a failed attempt\r\n\r\n# -
    Subscribers -\r\n\r\n# These settings are ignored on a publisher.\r\n\r\n#max_logical_replication_workers
    = 4\t# taken from max_worker_processes\r\n\t\t\t\t\t# (change requires restart)\r\n#max_sync_workers_per_subscription
    = 2\t# taken from max_logical_replication_workers\r\n\r\n\r\n#------------------------------------------------------------------------------\r\n#
    QUERY TUNING\r\n#------------------------------------------------------------------------------\r\n\r\n#
    - Planner Method Configuration -\r\n\r\n#enable_bitmapscan = on\r\n#enable_hashagg
    = on\r\n#enable_hashjoin = on\r\n#enable_indexscan = on\r\n#enable_indexonlyscan
    = on\r\n#enable_material = on\r\n#enable_mergejoin = on\r\n#enable_nestloop = on\r\n#enable_seqscan
    = on\r\n#enable_sort = on\r\n#enable_tidscan = on\r\n\r\n# - Planner Cost Constants
    -\r\n\r\n#seq_page_cost = 1.0\t\t\t# measured on an arbitrary scale\r\n#random_page_cost
    = 4.0\t\t\t# same scale as above\r\n#cpu_tuple_cost = 0.01\t\t\t# same scale as
    above\r\n#cpu_index_tuple_cost = 0.005\t\t# same scale as above\r\n#cpu_operator_cost
    = 0.0025\t\t# same scale as above\r\n#parallel_tuple_cost = 0.1\t\t# same scale
    as above\r\n#parallel_setup_cost = 1000.0\t# same scale as above\r\n#min_parallel_table_scan_size
    = 8MB\r\n#min_parallel_index_scan_size = 512kB\r\n#effective_cache_size = 4GB\r\n\r\n#
    - Genetic Query Optimizer -\r\n\r\n#geqo = on\r\n#geqo_threshold = 12\r\n#geqo_effort
    = 5\t\t\t# range 1-10\r\n#geqo_pool_size = 0\t\t\t# selects default based on effort\r\n#geqo_generations
    = 0\t\t\t# selects default based on effort\r\n#geqo_selection_bias = 2.0\t\t# range
    1.5-2.0\r\n#geqo_seed = 0.0\t\t\t# range 0.0-1.0\r\n\r\n# - Other Planner Options
    -\r\n\r\n#default_statistics_target = 100\t# range 1-10000\r\n#constraint_exclusion
    = partition\t# on, off, or partition\r\n#cursor_tuple_fraction = 0.1\t\t# range
    0.0-1.0\r\n#from_collapse_limit = 8\r\n#join_collapse_limit = 8\t\t# 1 disables
    collapsing of explicit\r\n\t\t\t\t\t# JOIN clauses\r\n#force_parallel_mode = off\r\n\r\n\r\n#------------------------------------------------------------------------------\r\n#
    ERROR REPORTING AND LOGGING\r\n#------------------------------------------------------------------------------\r\n\r\n#
    - Where to Log -\r\n\r\n#log_destination = 'stderr'\t\t# Valid values are combinations
    of\r\n\t\t\t\t\t# stderr, csvlog, syslog, and eventlog,\r\n\t\t\t\t\t# depending
    on platform.  csvlog\r\n\t\t\t\t\t# requires logging_collector to be on.\r\n\r\n#
    This is used when logging to stderr:\r\n#logging_collector = off\t\t# Enable capturing
    of stderr and csvlog\r\n\t\t\t\t\t# into log files. Required to be on for\r\n\t\t\t\t\t#
    csvlogs.\r\n\t\t\t\t\t# (change requires restart)\r\n\r\n# These are only used if
    logging_collector is on:\r\n#log_directory = 'log'\t\t\t# directory where log files
    are written,\r\n\t\t\t\t\t# can be absolute or relative to PGDATA\r\n#log_filename
    = 'postgresql-%Y-%m-%d_%H%M%S.log'\t# log file name pattern,\r\n\t\t\t\t\t# can
    include strftime() escapes\r\n#log_file_mode = 0600\t\t\t# creation mode for log
    files,\r\n\t\t\t\t\t# begin with 0 to use octal notation\r\n#log_truncate_on_rotation
    = off\t\t# If on, an existing log file with the\r\n\t\t\t\t\t# same name as the
    new log file will be\r\n\t\t\t\t\t# truncated rather than appended to.\r\n\t\t\t\t\t#
    But such truncation only occurs on\r\n\t\t\t\t\t# time-driven rotation, not on restarts\r\n\t\t\t\t\t#
    or size-driven rotation.  Default is\r\n\t\t\t\t\t# off, meaning append to existing
    files\r\n\t\t\t\t\t# in all cases.\r\n#log_rotation_age = 1d\t\t\t# Automatic rotation
    of logfiles will\r\n\t\t\t\t\t# happen after that time.  0 disables.\r\n#log_rotation_size
    = 10MB\t\t# Automatic rotation of logfiles will\r\n\t\t\t\t\t# happen after that
    much log output.\r\n\t\t\t\t\t# 0 disables.\r\n\r\n# These are relevant when logging
    to syslog:\r\n#syslog_facility = 'LOCAL0'\r\n#syslog_ident = 'postgres'\r\n#syslog_sequence_numbers
    = on\r\n#syslog_split_messages = on\r\n\r\n# This is only relevant when logging
    to eventlog (win32):\r\n# (change requires restart)\r\n#event_source = 'PostgreSQL'\r\n\r\n#
    - When to Log -\r\n\r\n#log_min_messages = warning\t\t# values in order of decreasing
    detail:\r\n\t\t\t\t\t#   debug5\r\n\t\t\t\t\t#   debug4\r\n\t\t\t\t\t#   debug3\r\n\t\t\t\t\t#
    \  debug2\r\n\t\t\t\t\t#   debug1\r\n\t\t\t\t\t#   info\r\n\t\t\t\t\t#   notice\r\n\t\t\t\t\t#
    \  warning\r\n\t\t\t\t\t#   error\r\n\t\t\t\t\t#   log\r\n\t\t\t\t\t#   fatal\r\n\t\t\t\t\t#
    \  panic\r\n\r\n#log_min_error_statement = error\t# values in order of decreasing
    detail:\r\n\t\t\t\t\t#   debug5\r\n\t\t\t\t\t#   debug4\r\n\t\t\t\t\t#   debug3\r\n\t\t\t\t\t#
    \  debug2\r\n\t\t\t\t\t#   debug1\r\n\t\t\t\t\t#   info\r\n\t\t\t\t\t#   notice\r\n\t\t\t\t\t#
    \  warning\r\n\t\t\t\t\t#   error\r\n\t\t\t\t\t#   log\r\n\t\t\t\t\t#   fatal\r\n\t\t\t\t\t#
    \  panic (effectively off)\r\n\r\n#log_min_duration_statement = -1\t# -1 is disabled,
    0 logs all statements\r\n\t\t\t\t\t# and their durations, > 0 logs only\r\n\t\t\t\t\t#
    statements running at least this number\r\n\t\t\t\t\t# of milliseconds\r\n\r\n\r\n#
    - What to Log -\r\n\r\n#debug_print_parse = off\r\n#debug_print_rewritten = off\r\n#debug_print_plan
    = off\r\n#debug_pretty_print = on\r\n#log_checkpoints = off\r\n#log_connections
    = off\r\n#log_disconnections = off\r\n#log_duration = off\r\n#log_error_verbosity
    = default\t\t# terse, default, or verbose messages\r\n#log_hostname = off\r\n#log_line_prefix
    = '%m [%p] '\t\t# special values:\r\n\t\t\t\t\t#   %a = application name\r\n\t\t\t\t\t#
    \  %u = user name\r\n\t\t\t\t\t#   %d = database name\r\n\t\t\t\t\t#   %r = remote
    host and port\r\n\t\t\t\t\t#   %h = remote host\r\n\t\t\t\t\t#   %p = process ID\r\n\t\t\t\t\t#
    \  %t = timestamp without milliseconds\r\n\t\t\t\t\t#   %m = timestamp with milliseconds\r\n\t\t\t\t\t#
    \  %n = timestamp with milliseconds (as a Unix epoch)\r\n\t\t\t\t\t#   %i = command
    tag\r\n\t\t\t\t\t#   %e = SQL state\r\n\t\t\t\t\t#   %c = session ID\r\n\t\t\t\t\t#
    \  %l = session line number\r\n\t\t\t\t\t#   %s = session start timestamp\r\n\t\t\t\t\t#
    \  %v = virtual transaction ID\r\n\t\t\t\t\t#   %x = transaction ID (0 if none)\r\n\t\t\t\t\t#
    \  %q = stop here in non-session\r\n\t\t\t\t\t#        processes\r\n\t\t\t\t\t#
    \  %% = '%'\r\n\t\t\t\t\t# e.g. '<%u%%%d> '\r\n#log_lock_waits = off\t\t\t# log
    lock waits >= deadlock_timeout\r\n#log_statement = 'none'\t\t\t# none, ddl, mod,
    all\r\n#log_replication_commands = off\r\n#log_temp_files = -1\t\t\t# log temporary
    files equal or larger\r\n\t\t\t\t\t# than the specified size in kilobytes;\r\n\t\t\t\t\t#
    -1 disables, 0 logs all temp files\r\nlog_timezone = 'Etc/UTC'\r\n\r\n\r\n# - Process
    Title -\r\n\r\n#cluster_name = ''\t\t\t# added to process titles if nonempty\r\n\t\t\t\t\t#
    (change requires restart)\r\n#update_process_title = on\r\n\r\n\r\n#------------------------------------------------------------------------------\r\n#
    RUNTIME STATISTICS\r\n#------------------------------------------------------------------------------\r\n\r\n#
    - Query/Index Statistics Collector -\r\n\r\n#track_activities = on\r\n#track_counts
    = on\r\n#track_io_timing = off\r\n#track_functions = none\t\t\t# none, pl, all\r\n#track_activity_query_size
    = 1024\t# (change requires restart)\r\n#stats_temp_directory = 'pg_stat_tmp'\r\n\r\n\r\n#
    - Statistics Monitoring -\r\n\r\n#log_parser_stats = off\r\n#log_planner_stats =
    off\r\n#log_executor_stats = off\r\n#log_statement_stats = off\r\n\r\n\r\n#------------------------------------------------------------------------------\r\n#
    AUTOVACUUM PARAMETERS\r\n#------------------------------------------------------------------------------\r\n\r\n#autovacuum
    = on\t\t\t# Enable autovacuum subprocess?  'on'\r\n\t\t\t\t\t# requires track_counts
    to also be on.\r\n#log_autovacuum_min_duration = -1\t# -1 disables, 0 logs all actions
    and\r\n\t\t\t\t\t# their durations, > 0 logs only\r\n\t\t\t\t\t# actions running
    at least this number\r\n\t\t\t\t\t# of milliseconds.\r\n#autovacuum_max_workers
    = 3\t\t# max number of autovacuum subprocesses\r\n\t\t\t\t\t# (change requires restart)\r\n#autovacuum_naptime
    = 1min\t\t# time between autovacuum runs\r\n#autovacuum_vacuum_threshold = 50\t#
    min number of row updates before\r\n\t\t\t\t\t# vacuum\r\n#autovacuum_analyze_threshold
    = 50\t# min number of row updates before\r\n\t\t\t\t\t# analyze\r\n#autovacuum_vacuum_scale_factor
    = 0.2\t# fraction of table size before vacuum\r\n#autovacuum_analyze_scale_factor
    = 0.1\t# fraction of table size before analyze\r\n#autovacuum_freeze_max_age = 200000000\t#
    maximum XID age before forced vacuum\r\n\t\t\t\t\t# (change requires restart)\r\n#autovacuum_multixact_freeze_max_age
    = 400000000\t# maximum multixact age\r\n\t\t\t\t\t# before forced vacuum\r\n\t\t\t\t\t#
    (change requires restart)\r\n#autovacuum_vacuum_cost_delay = 20ms\t# default vacuum
    cost delay for\r\n\t\t\t\t\t# autovacuum, in milliseconds;\r\n\t\t\t\t\t# -1 means
    use vacuum_cost_delay\r\n#autovacuum_vacuum_cost_limit = -1\t# default vacuum cost
    limit for\r\n\t\t\t\t\t# autovacuum, -1 means use\r\n\t\t\t\t\t# vacuum_cost_limit\r\n\r\n\r\n#------------------------------------------------------------------------------\r\n#
    CLIENT CONNECTION DEFAULTS\r\n#------------------------------------------------------------------------------\r\n\r\n#
    - Statement Behavior -\r\n\r\n#client_min_messages = notice\t\t# values in order
    of decreasing detail:\r\n\t\t\t\t\t#   debug5\r\n\t\t\t\t\t#   debug4\r\n\t\t\t\t\t#
    \  debug3\r\n\t\t\t\t\t#   debug2\r\n\t\t\t\t\t#   debug1\r\n\t\t\t\t\t#   log\r\n\t\t\t\t\t#
    \  notice\r\n\t\t\t\t\t#   warning\r\n\t\t\t\t\t#   error\r\n#search_path = '\"$user\",
    public'\t# schema names\r\n#default_tablespace = ''\t\t# a tablespace name, '' uses
    the default\r\n#temp_tablespaces = ''\t\t\t# a list of tablespace names, '' uses\r\n\t\t\t\t\t#
    only default tablespace\r\n#check_function_bodies = on\r\n#default_transaction_isolation
    = 'read committed'\r\n#default_transaction_read_only = off\r\n#default_transaction_deferrable
    = off\r\n#session_replication_role = 'origin'\r\n#statement_timeout = 0\t\t\t# in
    milliseconds, 0 is disabled\r\n#lock_timeout = 0\t\t\t# in milliseconds, 0 is disabled\r\n#idle_in_transaction_session_timeout
    = 0\t# in milliseconds, 0 is disabled\r\n#vacuum_freeze_min_age = 50000000\r\n#vacuum_freeze_table_age
    = 150000000\r\n#vacuum_multixact_freeze_min_age = 5000000\r\n#vacuum_multixact_freeze_table_age
    = 150000000\r\n#bytea_output = 'hex'\t\t\t# hex, escape\r\n#xmlbinary = 'base64'\r\n#xmloption
    = 'content'\r\n#gin_fuzzy_search_limit = 0\r\n#gin_pending_list_limit = 4MB\r\n\r\n#
    - Locale and Formatting -\r\n\r\ndatestyle = 'iso, mdy'\r\n#intervalstyle = 'postgres'\r\ntimezone
    = 'Etc/UTC'\r\n#timezone_abbreviations = 'Default'     # Select the set of available
    time zone\r\n\t\t\t\t\t# abbreviations.  Currently, there are\r\n\t\t\t\t\t#   Default\r\n\t\t\t\t\t#
    \  Australia (historical usage)\r\n\t\t\t\t\t#   India\r\n\t\t\t\t\t# You can create
    your own file in\r\n\t\t\t\t\t# share/timezonesets/.\r\n#extra_float_digits = 0\t\t\t#
    min -15, max 3\r\n#client_encoding = sql_ascii\t\t# actually, defaults to database\r\n\t\t\t\t\t#
    encoding\r\n\r\n# These settings are initialized by initdb, but they can be changed.\r\nlc_messages
    = 'en_US.utf8'\t\t\t# locale for system error message\r\n\t\t\t\t\t# strings\r\nlc_monetary
    = 'en_US.utf8'\t\t\t# locale for monetary formatting\r\nlc_numeric = 'en_US.utf8'\t\t\t#
    locale for number formatting\r\nlc_time = 'en_US.utf8'\t\t\t\t# locale for time
    formatting\r\n\r\n# default configuration for text search\r\ndefault_text_search_config
    = 'pg_catalog.english'\r\n\r\n# - Other Defaults -\r\n\r\n#dynamic_library_path
    = '$libdir'\r\n#extension_destdir = ''\t\t\t# prepend path when loading extensions\r\n\t\t\t\t\t#
    and shared objects (added by Debian)\r\n#local_preload_libraries = ''\r\n#session_preload_libraries
    = ''\r\n\r\n\r\n#------------------------------------------------------------------------------\r\n#
    LOCK MANAGEMENT\r\n#------------------------------------------------------------------------------\r\n\r\n#deadlock_timeout
    = 1s\r\n#max_locks_per_transaction = 64\t\t# min 10\r\n\t\t\t\t\t# (change requires
    restart)\r\n#max_pred_locks_per_transaction = 64\t# min 10\r\n\t\t\t\t\t# (change
    requires restart)\r\n#max_pred_locks_per_relation = -2\t# negative values mean\r\n\t\t\t\t\t#
    (max_pred_locks_per_transaction\r\n\t\t\t\t\t#  / -max_pred_locks_per_relation)
    - 1\r\n#max_pred_locks_per_page = 2            # min 0\r\n\r\n\r\n#------------------------------------------------------------------------------\r\n#
    VERSION/PLATFORM COMPATIBILITY\r\n#------------------------------------------------------------------------------\r\n\r\n#
    - Previous PostgreSQL Versions -\r\n\r\n#array_nulls = on\r\n#backslash_quote =
    safe_encoding\t# on, off, or safe_encoding\r\n#default_with_oids = off\r\n#escape_string_warning
    = on\r\n#lo_compat_privileges = off\r\n#operator_precedence_warning = off\r\n#quote_all_identifiers
    = off\r\n#standard_conforming_strings = on\r\n#synchronize_seqscans = on\r\n\r\n#
    - Other Platforms and Clients -\r\n\r\n#transform_null_equals = off\r\n\r\n\r\n#------------------------------------------------------------------------------\r\n#
    ERROR HANDLING\r\n#------------------------------------------------------------------------------\r\n\r\n#exit_on_error
    = off\t\t\t# terminate session on any error?\r\n#restart_after_crash = on\t\t# reinitialize
    after backend crash?\r\n#data_sync_retry = off\t\t\t# retry or panic on failure
    to fsync\r\n\t\t\t\t\t# data?\r\n\t\t\t\t\t# (change requires restart)\r\n\r\n\r\n#------------------------------------------------------------------------------\r\n#
    CONFIG FILE INCLUDES\r\n#------------------------------------------------------------------------------\r\n\r\n#
    These options allow settings to be loaded from files other than the\r\n# default
    postgresql.conf.  Note that these are directives, not variable\r\n# assignments,
    so they can usefully be given more than once.\r\n\r\n#include_dir = '...'\t\t\t#
    include files ending in '.conf' from\r\n\t\t\t\t\t# a directory, e.g., 'conf.d'\r\n#include_if_exists
    = '...'\t\t# include file only if it exists\r\n#include = '...'\t\t\t# include file\r\n\r\n\r\n#------------------------------------------------------------------------------\r\n#
    CUSTOMIZED OPTIONS\r\n#------------------------------------------------------------------------------\r\n\r\n#
    Add settings for extensions here\r\n"
  recovery.conf: "standby_mode = on\r\nprimary_conninfo = 'host=primarydb-svc port=5432
    user=repuser password=changeme application_name=r1'\r\nprimary_slot_name = 'replica_1_slot'
    # Name of the replication slot we created on the master\r\ntrigger_file = '/var/lib/postgresql/data/change_to_master'"
---
# Source: python-web-app/charts/primarydb/templates/pv.yaml
apiVersion: v1
kind: PersistentVolume
metadata:
  name: primarydb
  namespace: python-app
  labels:
    type: local
spec:
  storageClassName: "hostpath"
  capacity:
    storage: "1Gi"
  accessModes:
    - "ReadWriteOnce"
  hostPath:
    path: "/home/shashank/study/web/python-app-microservice-main/testmount/primarydb/"
---
# Source: python-web-app/charts/readreplica/templates/pv.yaml
apiVersion: v1
kind: PersistentVolume
metadata:
  name: standbydb
  namespace: python-app
  labels:
    type: local
spec:
  storageClassName: "hostpath"
  capacity:
    storage: "1Gi"
  accessModes:
    - "ReadWriteOnce"
  hostPath:
    path: "/home/shashank/study/web/python-app-microservice-main/testmount/standbydb"
---
# Source: python-web-app/charts/primarydb/templates/pvc.yaml
kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: primdb
  namespace: python-app
spec:
  accessModes:
    - "ReadWriteOnce"
  resources:
    requests:
      storage: "1Gi"
  volumeName: "primarydb"
  storageClassName: "hostpath"
---
# Source: python-web-app/charts/readreplica/templates/pvc.yaml
kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: standbydb
  namespace: python-app
spec:
  accessModes:
    - "ReadWriteOnce"
  resources:
    requests:
      storage: "1Gi"
  volumeName: "standbydb"
  storageClassName: "hostpath"
---
# Source: python-web-app/charts/primarydb/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: primarydb-svc
  namespace: python-app
  labels:
    helm.sh/chart: primarydb-0.1.0
    app.kubernetes.io/name: primarydb
    app.kubernetes.io/instance: release-name
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  type: NodePort
  ports:
    - port: 5432
      protocol: TCP
      targetPort: 5432
      
  selector:
    app.kubernetes.io/name: primarydb
    app.kubernetes.io/instance: release-name
---
# Source: python-web-app/charts/pythonapp/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: python-app-svc
  namespace: python-app
  labels:
    helm.sh/chart: pythonapp-0.1.0
    app.kubernetes.io/name: pythonapp
    app.kubernetes.io/instance: release-name
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  type: LoadBalancer
  ports:
    - protocol: TCP
      port: 8080
      targetPort: 8080
      nodePort: 30008
  selector:
    app.kubernetes.io/name: pythonapp
    app.kubernetes.io/instance: release-name
---
# Source: python-web-app/charts/readreplica/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: standbydb-svc
  namespace: python-app
  labels:
    helm.sh/chart: readreplica-0.1.0
    app.kubernetes.io/name: readreplica
    app.kubernetes.io/instance: release-name
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  type: NodePort
  ports:
    - port: 5432
      protocol: TCP
      targetPort: 5432
      
  selector:
    app.kubernetes.io/name: readreplica
    app.kubernetes.io/instance: release-name
---
# Source: python-web-app/charts/primarydb/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: release-name-primarydb
  namespace: python-app
  labels:
    helm.sh/chart: primarydb-0.1.0
    app.kubernetes.io/name: primarydb
    app.kubernetes.io/instance: release-name
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: primarydb
      app.kubernetes.io/instance: release-name
  template:
    metadata:
      labels:
        app.kubernetes.io/name: primarydb
        app.kubernetes.io/instance: release-name
    spec:
      containers:
        - name: postgres-primary
          image: "postgres:10"
          imagePullPolicy: IfNotPresent
          ports:
            - containerPort: 5432
          lifecycle:
            postStart:
              exec:
                command:
                  - /bin/sh
                  - -ec
                  - |
                    sleep 10
                    cp /var/lib/postgresql/data/postgresql.main.conf /var/lib/postgresql/data/pythonapp/postgresql.conf
                    cp /var/lib/postgresql/data/pg_hba.main.conf /var/lib/postgresql/data/pythonapp/pg_hba.conf
                    chmod 600 /var/lib/postgresql/data/pythonapp/postgresql.conf
                    chmod 600 /var/lib/postgresql/data/pythonapp/pg_hba.conf
                    sleep 5
                    # psql -U admin python-app -a -f /var/lib/postgresql/data/initial.sql
          env:
          - name: POSTGRES_PASSWORD
            valueFrom:
              secretKeyRef:
                name: python-app-secrets
                key: POSTGRES_PASSWORD
          - name: POSTGRES_USER
            value: "admin"
          - name: POSTGRES_DB
            value: "python-app"
          - name: PGDATA
            value: /var/lib/postgresql/data/pythonapp
          volumeMounts:
            - name: pgprim
              mountPath: /var/lib/postgresql/data
            - name: prim-config-mnt
              mountPath: /var/lib/postgresql/data/postgresql.main.conf
              subPath: postgresql.conf
            - name: prim-config-mnt
              mountPath: /var/lib/postgresql/data/pg_hba.main.conf
              subPath: pg_hba.conf
            - name: prim-config-mnt
              mountPath: /docker-entrypoint-initdb.d/initial.sql
              subPath: initial.sql
      volumes:
      - name: pgprim
        persistentVolumeClaim:
          claimName: primdb
      - name: prim-config-mnt
        configMap:
          name: release-name-configmap
---
# Source: python-web-app/charts/pythonapp/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: release-name-pythonapp
  namespace: python-app
  labels:
    helm.sh/chart: pythonapp-0.1.0
    app.kubernetes.io/name: pythonapp
    app.kubernetes.io/instance: release-name
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: pythonapp
      app.kubernetes.io/instance: release-name
  template:
    metadata:
      labels:
        app.kubernetes.io/name: pythonapp
        app.kubernetes.io/instance: release-name
        checksum/config: 6cc66f36f402fb5687dce45882ceb61ed51dff06aff11d524c1c30b5f56f0535
    spec:
      initContainers:
      - name: check-db-ready
        image: postgres:10
        imagePullPolicy: IfNotPresent
        command: ['sh', '-c', 'until pg_isready -h standbydb-svc -p 5432; do echo waiting for database; sleep 2; done; ']
      containers:
      - image: "shashank30mishra/test_web_n:latest"
        imagePullPolicy: IfNotPresent
        name: python-web-app
        ports:
          - containerPort: 8080
        env:
          - name: DBUSER
            value: "admin"
          - name: DBHOST
            value: primarydb-svc
          - name: DBNAME
            value: "python-app"
          - name: POSTGRES_PASSWORD
            valueFrom:
              secretKeyRef:
                name: python-secrets
                key: POSTGRES_PASSWORD
          - name: ADMIN_PASSWORD
            valueFrom:
              secretKeyRef:
                name: python-secrets
                key:  ADMIN_PASSWORD
        volumeMounts:
        - name: config-volume
          mountPath: /myapp1/config/
      volumes:
      - name: config-volume
        configMap:
          name: my-config
---
# Source: python-web-app/charts/readreplica/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: release-name-readreplica-sb
  namespace: python-app
  labels:
    helm.sh/chart: readreplica-0.1.0
    app.kubernetes.io/name: readreplica
    app.kubernetes.io/instance: release-name
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm-sb
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: readreplica
      app.kubernetes.io/instance: release-name
  template:
    metadata:
      labels:
        app.kubernetes.io/name: readreplica
        app.kubernetes.io/instance: release-name
    spec:
      containers:
        - name: postgres-sb
          image: "postgres:10"
          imagePullPolicy: IfNotPresent
          ports:
            - containerPort: 5432
          env:
          - name: POSTGRES_PASSWORD
            valueFrom:
              secretKeyRef:
                name: python-app-secrets
                key: POSTGRES_PASSWORD
          - name: POSTGRES_USER
            value: "admin"
          - name: POSTGRES_DB
            value: "python-app"
          - name: PGDATA
            value: /var/lib/postgresql/data/pythonapp
          volumeMounts:
            - name: pgsb
              mountPath: /var/lib/postgresql/data
            - name: sb-config-mnt
              mountPath: /var/lib/postgresql/data/postgresql.main.conf
              subPath: postgresql.conf
            - name: sb-config-mnt
              mountPath: /var/lib/postgresql/data/recovery.conf
              subPath: recovery.conf
      volumes:
      - name: pgsb
        persistentVolumeClaim:
          claimName: standbydb
      - name: sb-config-mnt
        configMap:
          name: release-name-configmap-sb
      initContainers:
      - name: init-standby
        image: "postgres:10"
        imagePullPolicy: IfNotPresent
        command:
          - /bin/sh
          - -ec
          - | 
            until pg_isready -h primarydb-svc -p 5432; 
            do echo waiting for database; sleep 2; 
            done;
            rm -rf /var/lib/postgresql/data/pythonapp &&
            PGPASSWORD="changeme" pg_basebackup -h primarydb-svc -D /var/lib/postgresql/data/pythonapp -U repuser -vP
            cp /var/lib/postgresql/data/postgresql.main.conf /var/lib/postgresql/data/pythonapp/postgresql.conf
            cp /var/lib/postgresql/data/recovery.main.conf /var/lib/postgresql/data/pythonapp/recovery.conf
            chmod 600 /var/lib/postgresql/data/pythonapp/postgresql.conf
            chmod 600 /var/lib/postgresql/data/pythonapp/recovery.conf
        volumeMounts:
        - name: pgsb
          mountPath: /var/lib/postgresql/data
        - name: sb-config-mnt
          mountPath: /var/lib/postgresql/data/postgresql.main.conf
          subPath: postgresql.conf
        - name: sb-config-mnt
          mountPath: /var/lib/postgresql/data/recovery.main.conf
          subPath: recovery.conf
---
# Source: python-web-app/charts/pythonapp/templates/ingress.yaml
kind: Ingress
apiVersion: networking.k8s.io/v1
metadata:
  name: release-name-pythonapp-ingress
  namespace: python-app
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/ssl-redirect: "false"
    nginx.ingress.kubernetes.io/rewrite-target: /
spec:
  tls:
    - hosts:
        - "blog.domain.com"
  rules:
    - host: "blog.domain.com"
      http:
        paths:
          - path: "/"
            pathType: Prefix
            backend:
              service:
                name: python-app-svc
                port:
                  number: 8080
